# panel-gene-mutations-correlation-with-clinical-response
library("survival")
data=read.delim("input//Mutations_PFS.txt",head=T,sep="\t")
data=read.delim("input//Mutations_OS.txt",head=T,sep="\t")
data=read.delim("input//Mutations_DOR.txt",head=T,sep="\t")
data=read.delim("input//Mutations_TTR.txt",head=T,sep="\t")
ls(data)
surv_object=Surv(time=data$futime,event=data$fustat)
survdiff(Surv(time=data$futime,event=data$fustat)~TP53,data) #test pvalue (log-rank test)
fit=survfit(surv_object~TP53,data=data)
summary(fit)
plot(fit,mark=3,col=c("black","green","gray"),lty=c(1),lwd=1,conf.int=FALSE,ylab="OS (Investigator)",xlab="days",cex.axis=0.8,cex.lab=0.8)
legend(5, .4, c("TP53 wildtype (n=39)","TP53 with mutation (n=15)","TP53 without testing (n=32)","p=0.02"),col=c("black","green","gray"),lty=c(1),cex=0.6)
#to plot forest for hazard ratio
install.packages("survminer")
library("survminer")
require("survival")
model=coxph(Surv(data$futime,data$fustat)~TP53,data=data)
ggforest(model,data=data,fontsize=0.6,main="OS hazard ratio")
